<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.itwillbs.mappers.employeeMapper">



<!-- 로그인-강수빈 -->
	<select id="userCheck"  resultType="com.keypoint.dto.EmployeeDTO">
		select * from employees
		where empId = #{empId} and empPass = #{empPass}
	</select>
	
	
<!-- 사원목록 --> 
	<select id="getEmployeeList" resultType="com.keypoint.dto.EmployeeDTO">
		select *
		from employees
		order by empId DESC
		LIMIT #{startRow}, #{pageSize}
	</select>
	
	<select id="getEmployeeCount" resultType="java.lang.Integer">
		select count(*) 
		from employees
	</select>


<!-- 사원등록 -->
	<insert id="insertEmployee">
		insert into employees (empPass, empName, empPhoto, empBirth, empPhone, empTel, empEmail, 
		                                   empAddress, departmentName, empPosition, empHiredate, empStatus, empRole)
		values (#{empPass}, #{empName}, #{empPhoto}, #{empBirth}, #{empPhone}, #{empTel}, #{empEmail},
			       #{empAddress}, #{departmentName}, #{empPosition}, #{empHiredate}, #{empStatus}, #{empRole})
	</insert>
	
<!-- 사원-상세정보 -->
	<select id="getEmployeeDetails" resultType="com.keypoint.dto.EmployeeDTO">
		select empId, empPass, empName, empPhoto, empBirth, empPhone, empTel, empEmail, empAddress,
		empStatus, departmentName, empPosition, empHiredate, empLeavedate, empRetiredate, empRole
		from employees
		where empId = #{empId}
	</select>	

<!-- 사원-상세정보수정 -->
	<update id="updateEmployee">
		update employees
		set empPhoto = #{empPhoto}, empPhone = #{empPhone}, empTel = #{empTel}, 
		empEmail = #{empEmail}, empStatus = #{empStatus}, departmentName = #{departmentName},
		empPosition = #{empPosition},   empRole = #{empRole} 
<!-- 		값들이 비어있어도 넘어가게!!!! -->
		<if test="empLeavedate != null and empLeavedate != ''">
    	, empLeavedate = #{empLeavedate}
		</if>
		<if test ="empRetiredate != null and empRetiredate != ''">
		, empRetiredate= #{empRetiredate}
		</if>
		<if test ="empHiredate != null and empHiredate != ''">
		, empHiredate= #{empHiredate}
		</if>
		where empId = #{empId}
	</update> 



<!-- 사원 등록 - 연락처 중복체크 -->
	<select id="empPhoneCheck" resultType="com.keypoint.dto.EmployeeDTO">
		select *
		from employees
		where empPhone = #{empPhone}
	</select>
	
	
</mapper>

